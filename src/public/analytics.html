<!-- analytics.html: Analytics Page -->
<!<script src="auth.js"></script>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analytics - Clear Aligner Case Tracker Pro</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Reuse styles from dashboard.html */
    .chart-container {
      position: relative;
      height: 400px;
      margin: 20px 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .stat-card {
      background: var(--light, white);
      padding: 20px;
      border-radius: var(--radius);
      text-align: center;
      box-shadow: var(--shadow);
    }

    body[data-theme="dark"] .stat-card {
      background: var(--card-bg);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--primary);
    }

    .stat-label {
      color: var(--secondary);
      margin-top: 5px;
    }

    .filter-bar {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .filter-bar select, .filter-bar input {
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Header and sidebar as in dashboard -->

    <div class="main-content">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Analytics Dashboard</div>
          <div class="filter-bar">
            <select id="timeFilter">
              <option value="week">This Week</option>
              <option value="month">This Month</option>
              <option value="year">This Year</option>
            </select>
            <input type="date" id="dateFilter" />
            <button class="btn btn-primary" onclick="updateCharts()">Filter</button>
          </div>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value">95%</div>
            <div class="stat-label">Avg Compliance</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">24</div>
            <div class="stat-label">Active Patients</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">4.2</div>
            <div class="stat-label">Avg Turnaround (Days)</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">92%</div>
            <div class="stat-label">Eco Score</div>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="overallChart"></canvas>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="chart-container">
            <canvas id="complianceChart"></canvas>
          </div>
          <div class="chart-container">
            <canvas id="progressChart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Load analytics data
    async function loadAnalytics() {
      // Fetch from /api/analytics
      const data = { /* Mock or API data */ };
      updateCharts(data);
    }

    function updateCharts(data) {
      // Update Chart.js charts
      const overallCtx = document.getElementById('overallChart').getContext('2d');
      new Chart(overallCtx, {
        type: 'doughnut',
        data: {
          labels: ['Completed', 'Active', 'Pending'],
          datasets: [{
            data: [40, 50, 10],
            backgroundColor: ['#10b981', '#3b82f6', '#f59e0b']
          }]
        }
      });

      // Similar for other charts
    }

    document.addEventListener('DOMContentLoaded', loadAnalytics);
  </script>
</body>
</html>